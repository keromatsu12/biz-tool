# フロントエンド開発ガイドライン

## 1. ブランチ運用とコミット規約 (Git Flow)

標準的な Git Flow 戦略と Conventional Commits を採用します。

### 1.1. ブランチ戦略

| ブランチ名  | 役割                                       | 分岐元  | マージ先      | 命名規則         |
| :---------- | :----------------------------------------- | :------ | :------------ | :--------------- |
| **main**    | 本番環境用。常にリリース可能な状態を維持。 | -       | -             | -                |
| **develop** | 開発用。次期リリースのための統合ブランチ。 | main    | -             | -                |
| **feature** | 新機能開発や変更。                         | develop | develop       | `feature/記述`   |
| **bugfix**  | リリース前のバグ修正。                     | develop | develop       | `bugfix/記述`    |
| **release** | リリース準備（バージョン番号の更新など）。 | develop | main, develop | `release/vX.Y.Z` |
| **hotfix**  | 本番環境の緊急修正。                       | main    | main, develop | `hotfix/記述`    |

### 1.2. コミットメッセージのフォーマット

Conventional Commits に従い、以下のフォーマットを使用してください。

`<type>: <subject>`

**Types:**

- **feat:** 新機能
- **fix:** バグ修正
- **docs:** ドキュメントのみの変更
- **style:** コードの動作に影響しない変更（空白、フォーマットなど）
- **refactor:** バグ修正も機能追加も行わないコードの変更
- **perf:** パフォーマンスを向上させるコードの変更
- **test:** テストの追加や修正
- **chore:** ビルドプロセスやドキュメント生成などの補助ツールやライブラリの変更

**例:**

- `feat: ログイン機能を追加`
- `fix: ヘッダーのレイアウト崩れを修正`
- `chore: パッケージ依存関係を更新`

### 1.3. Pull Request (PR) 運用

- PR のタイトルはコミットメッセージと同様のフォーマット (`<type>: <subject>`) を推奨します。
- PR 作成時に適切なマージ先（通常は `develop`）を選択してください。
- PR のタイトルと説明は日本語で記述してください。

## 2. 開発環境と技術スタック

### 2.1. 技術スタック

- **Framework:** Nuxt 4.2
- **Library:** Vue 3.5
- **Runtime:** Node.js 22
- **Language:** TypeScript

### 2.2. 開発環境

Docker を使用したコンテナ環境で開発を行います。

**起動手順:**

```bash
docker compose up
```

## 3. Nuxt 4 SCSS 開発規約 (SCSS Coding Standards)

### 3.1. 環境構築とパッケージ管理

- **ビルド高速化:** パフォーマンス向上のため、Dart Sassのバイナリ版である `sass-embedded` を導入する。大規模プロジェクトではビルド時間を約30%短縮できる。
- **不要なオプションの削除:** Nuxt 3移行時の名残である `javascriptEnabled: true` はLess用の設定であり、SCSSでは不要なため削除する。
- **ソースマップ設定:** デバッグ効率と本番パフォーマンスを両立するため、開発環境のみ有効化する。

### 3.2. ディレクトリ構造とファイル設計

- **関心の分離:** `assets/scss/` (基本的には `layers/base/app/assets/scss/`) 配下を以下の階層で管理し、役割を明確化する。
    - `foundation/`: 変数（`_variables.scss`）、Mixin（`_mixins.scss`）、関数（`_functions.scss`）。
    - `tokens/`: カラーやタイポグラフィなどのデザイントークン。
    - `utilities/`: ヘルパークラスなど。
    - `main.scss`: グローバルスタイルの集約点。
- **Partialの徹底:** 不要なCSS生成を防ぐため、定義ファイルには必ずアンダースコア（`_`）を付与する。
- **モジュール管理:** 非推奨の `@import` は使用せず、`@use` および `@forward` を使用する。

### 3.3. Nuxt設定（注入と配信の使い分け）

- **additionalData (注入):** 変数、Mixin、関数、プレースホルダーなど、「CSSを直接出力しない定義」のみを記述する。
    - 実スタイルを記述すると、全ファイルに重複注入されバンドルサイズが増大するため厳禁とする。
- **css 配列 (配信):** リセットCSS、ベーススタイル、ユーティリティなど、**「CSSとして出力すべきスタイル」**を指定する。

### 3.4. 実装パターンと命名規則

- **名前空間（Namespace）の選択:**
    - **中小規模:** `as *` を使用し、直接参照で記述を簡潔にする。ただし、変数名の衝突に注意する。
    - **大規模:** `as var` や `as mx` などの名前空間を付与し、リソースの出所を明確にする。
- **循環参照の回避:** 以下の階層構造（Layered Architecture）を遵守し、上位層が下位層を参照する形を徹底する。
    1. **基礎層 (Foundation):** 他を参照しない基本定義
    2. **トークン層 (Tokens):** 基礎層のみ参照
    3. **コンポーネント層 (Components):** 基礎層とトークン層を参照
    4. **ページ層 (Pages):** 全ての層を参照可能

- **BEM記法とプレフィックス:**
    - クラス名はBEM記法 (`Block__Element--Modifier`) を採用する。
    - 役割を明確にするため、以下のプレフィックスを付与する。
        - `l-`: Layout (レイアウト) - 例: `l-app`, `l-main`
        - `c-`: Component (コンポーネント) - 例: `c-header`, `c-btn`
        - `p-`: Page (ページ固有) - 例: `p-home`, `p-login`
        - `u-`: Utility (ユーティリティ) - 例: `u-text-center`

### 3.5. 保守性と連携

- **ドキュメント化:** 変数やMixinにはSassDoc形式のコメントを付与し、スタイルガイドを自動生成できる状態に保つ。
- **デザインシステム連携:** 必要に応じてデザイントークン（JSON）からSCSS変数を自動生成するスクリプトを活用する。
- **JSとの連携:** スタイルとロジックの一貫性を保つため、`:export` 機能を使用してSCSS変数をJavaScriptから参照可能にする。
